<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#000000" />
  <title>Projects — MG Capital CRM</title>
  <style>
    :root{--bg:#0a0b10;--card:#121320;--muted:#8b90a5;--text:#eef1ff;--accent:#6e7bff;--accent-2:#45d1c4;--danger:#ff6b6b;--success:#32d49e;--warning:#ffcc66;--ring:0 0 0 2px color-mix(in oklab,var(--accent),transparent 60%);--radius:18px;}
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font-family:ui-sans-serif,-apple-system,Segoe UI,Roboto,Inter,system-ui;background:radial-gradient(1000px 600px at -10% -10%,#2b2e74 0%,transparent 60%),radial-gradient(900px 600px at 110% 10%,#0d5b64 0%,transparent 60%),linear-gradient(180deg,#0a0b10,#0a0b10);color:var(--text)}

    .container{width:100%;max-width:1200px;margin-inline:auto;padding:16px}
    header{display:flex;gap:12px;align-items:center;justify-content:space-between;margin-bottom:16px;flex-wrap:wrap}
    .brand{display:flex;align-items:center;gap:12px}
    .logo{width:40px;height:40px;border-radius:12px;background:linear-gradient(135deg,var(--accent),var(--accent-2));display:grid;place-items:center;font-weight:800;color:#fff;box-shadow:0 8px 30px #0008}
    h1{font-size:clamp(20px,3vw,26px);margin:0}
    .toolbar{display:flex;gap:8px;flex-wrap:wrap}
    .btn{padding:10px 12px;border-radius:12px;border:1px solid #ffffff1a;background:#ffffff10;color:var(--text);cursor:pointer;transition:.2s;backdrop-filter:blur(6px);text-decoration:none;display:inline-block;text-align:center;font-size:14px}
    .btn:hover{transform:translateY(-1px);background:#ffffff1a}
    .btn.primary{background:linear-gradient(135deg,var(--accent),#4b56f7);border-color:#0000;box-shadow:0 6px 24px #6e7bff33}
    .btn.ghost{background:#ffffff08}

    .metrics{display:grid;gap:12px;grid-template-columns:repeat(4,1fr)}
    .card{background:linear-gradient(180deg,#101123,#0c0d18);border:1px solid #ffffff10;border-radius:18px;padding:12px;box-shadow:0 10px 30px #0006}
    .metric{display:flex;flex-direction:column;gap:6px}
    .metric h3{margin:0;color:#cfd6ff;font-weight:600;font-size:13px}
    .metric .value{font-size:20px;font-weight:800;margin:2px 0 2px}
    .pill{align-self:flex-start;margin-top:auto;font-size:11px;padding:4px 9px;border-radius:999px;background:#ffffff0f;border:1px solid #ffffff1a;white-space:nowrap}

    #tableView{overflow-x:auto;-webkit-overflow-scrolling:touch}
    table{width:100%;border-collapse:separate;border-spacing:0 6px;font-size:14px}
    thead th{font-size:11px;text-transform:uppercase;letter-spacing:.08em;color:#b4b8d6;text-align:left;padding:0 10px}
    tbody tr{background:#0e1020;border:1px solid #ffffff14}
    tbody td{padding:10px}
    tbody tr td:first-child{border-top-left-radius:12px;border-bottom-left-radius:12px}
    tbody tr td:last-child{border-top-right-radius:12px;border-bottom-right-radius:12px}

    .board{display:grid;grid-template-columns:repeat(4,1fr);gap:14px}
    .column{min-height:280px;background:#0e1020;border:1px solid #ffffff14;border-radius:18px;padding:12px}
    .col-head{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px;font-size:14px}
    .card-mini{background:#11142a;border:1px solid #ffffff12;border-radius:14px;padding:10px;margin-bottom:10px;font-size:13px}

    footer{opacity:.7;margin-top:16px;font-size:12px}

    dialog{border:1px solid #ffffff2a;background:#0e1020;color:var(--text);border-radius:14px;padding:0;width:min(720px,96vw);max-height:90vh;font-size:13px}
    dialog::backdrop{background:#0008}
    .modal-head{display:flex;align-items:center;justify-content:space-between;padding:12px 14px;border-bottom:1px solid #ffffff1a;font-size:14px}
    .modal-body{padding:12px 14px;display:grid;gap:8px;overflow:auto}
    .modal-actions{display:flex;justify-content:flex-end;gap:8px;padding:10px 14px;border-top:1px solid #ffffff1a}
    .two{display:grid;grid-template-columns:1fr 1fr;gap:8px}

    .tabs{display:flex;gap:6px;margin-top:6px;font-size:13px}
    .tab{padding:6px 10px;border-radius:999px;border:1px solid #ffffff1a;background:#ffffff08;cursor:pointer}
    .tab.active{background:linear-gradient(135deg,var(--accent),#4b56f7);border-color:#0000}

    .hidden{display:none}

    @media (max-width:1024px){.board{grid-template-columns:1fr 1fr}}
    @media (max-width:640px){
      .container{padding:14px}
      .metrics{grid-template-columns:repeat(2,1fr)}
      .metric h3{font-size:13px}
      .metric .value{font-size:19px}
      .pill{font-size:10px;max-width:100%;overflow:hidden;text-overflow:ellipsis;display:inline-block;margin-top:4px}
      .board{grid-template-columns:1fr}
      #tableView>table{min-width:600px}
      .two{grid-template-columns:1fr}
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="brand">
        <div class="logo">MG</div>
        <div><h1>Projects Dashboard</h1></div>
      </div>
      <div class="toolbar">
        <a href="projects.html" class="btn primary">Projects</a>
        <a href="investors.html" class="btn ghost">Investors</a>
      </div>
      <div class="toolbar">
        <button class="btn primary" id="addBtn">+ Add Project</button>
        <button class="btn ghost" id="exportBtn">Export Projects</button>
        <button class="btn ghost" id="importBtn">Import Projects</button>
        <button class="btn" id="backupBtn">Backup</button>
        <button class="btn" id="restoreBtn">Restore</button>
        <button class="btn" id="toggleViewBtn">Toggle View</button>
      </div>
    </header>

    <section class="metrics">
      <div class="card"><div class="metric"><h3>Total Projects</h3><div class="value" id="mCount">0</div></div></div>
      <div class="card"><div class="metric"><h3>Active</h3><div class="value" id="mActive">0</div></div></div>
      <div class="card"><div class="metric"><h3>In Development</h3><div class="value" id="mDev">0</div></div></div>
      <div class="card"><div class="metric"><h3>Proposed</h3><div class="value" id="mProp">0</div></div></div>
    </section>

    <section class="card" style="margin-top:12px">
      <div class="split">
        <strong>Projects</strong>
        <span class="right"></span>
        <input id="q" placeholder="Search projects…" style="min-width:220px" />
        <div class="tabs"><button class="tab active" data-view="table">Table</button><button class="tab" data-view="board">Board</button></div>
      </div>
      <div id="tableView" style="margin-top:10px">
        <table>
          <thead><tr><th>Name</th><th>Status</th><th>Owner</th><th>Next Step</th><th></th></tr></thead>
          <tbody id="rows"></tbody>
        </table>
      </div>
      <div id="boardView" class="board hidden" style="margin-top:10px"></div>
    </section>

    <footer>Data is saved locally in your browser. Export CSV for backups. — MG Capital</footer>
  </div>

  <!-- Modals -->
  <dialog id="modal"><form method="dialog">
    <div class="modal-head"><strong id="modalTitle">Add Project</strong><button class="btn" value="close">✕</button></div>
    <div class="modal-body">
      <label>Name<br/><input id="f_name" required /></label>
      <label>Status<br/><select id="f_status"><option>Active</option><option>In Development</option><option>Proposed</option><option>On Hold</option></select></label>
      <label>Owner<br/><input id="f_owner" /></label>
      <label>Next Step<br/><input id="f_next" /></label>
      <input id="f_id" type="hidden" />
    </div>
    <div class="modal-actions"><button class="btn" value="close">Cancel</button><button class="btn primary" id="saveBtn">Save</button></div>
  </form></dialog>

  <script>
    const STATUSES=["Active","In Development","Proposed","On Hold"];
    function uid(){return Math.random().toString(36).slice(2)+Date.now().toString(36)}
    function load(){try{return JSON.parse(localStorage.getItem('mgcrm_projects')||'[]')}catch{return[]}}
    function save(){localStorage.setItem('mgcrm_projects',JSON.stringify(db));render()}
    let db=load();

    function render(){
      const q=document.getElementById('q').value.toLowerCase();
      const items=db.filter(x=>!q||x.name.toLowerCase().includes(q));
      rows.innerHTML=items.map(rowHTML).join('');
      boardView.innerHTML=STATUSES.map(s=>{const list=items.filter(x=>x.status===s);return`<div class="column"><div class="col-head"><strong>${s}</strong><span class="pill">${list.length}</span></div>${list.map(cardHTML).join('')}</div>`}).join('');
      mCount.textContent=db.length;
      mActive.textContent=db.filter(x=>x.status==="Active").length;
      mDev.textContent=db.filter(x=>x.status==="In Development").length;
      mProp.textContent=db.filter(x=>x.status==="Proposed").length;
    }
    function rowHTML(x){return`<tr><td>${x.name}</td><td>${x.status}</td><td>${x.owner}</td><td>${x.next}</td><td><button class=btn onclick='edit("${x.id}")'>Edit</button></td></tr>`}
    function cardHTML(x){return`<div class="card-mini"><strong>${x.name}</strong><div class=muted>${x.owner||''}</div><div>${x.status}</div><div>${x.next||''}</div></div>`}

    addBtn.onclick=()=>edit();
    saveBtn.onclick=e=>{e.preventDefault();const id=f_id.value||uid();const o={id,name:f_name.value,status:f_status.value,owner:f_owner.value,next:f_next.value};const i=db.findIndex(x=>x.id===id);if(i>-1)db[i]=o;else db.push(o);save();modal.close()}
    function edit(id){const x=db.find(r=>r.id===id)||{id:"",name:"",status:"Active",owner:"",next:""};f_id.value=x.id;f_name.value=x.name;f_status.value=x.status;f_owner.value=x.owner;f_next.value=x.next;modal.showModal()}

    document.getElementById('toggleViewBtn').onclick=()=>{
      const isTable=!tableView.classList.contains('hidden');
      document.querySelector(`.tab[data-view="${isTable?'board':'table'}"]`).click()}
    document.querySelectorAll('.tab[data-view]').forEach(btn=>btn.onclick=()=>{
      document.querySelectorAll('.tab[data-view]').forEach(b=>b.classList.remove('active'));
      btn.classList.add('active');
      tableView.classList.toggle('hidden',btn.dataset.view!=='table');
      boardView.classList.toggle('hidden',btn.dataset.view!=='board');
    });

    render();
  </script>
</body>
</html>
